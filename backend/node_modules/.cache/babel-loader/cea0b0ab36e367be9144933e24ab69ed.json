{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\dardo\\\\Desktop\\\\e-commerce\\\\frontend\\\\src\\\\components\\\\Products\\\\checkoutForm.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport { Button, Form } from \"react-bootstrap\";\nimport axios from \"axios\";\nimport { connect } from \"react-redux\";\nimport Select from \"react-select\";\n\nconst CheckoutForm = ({\n  success,\n  user\n}) => {\n  _s();\n\n  const stripe = useStripe();\n  const elements = useElements();\n  const [countries, setCountries] = React.useState([]);\n  const [address_data, setData] = React.useState({\n    apartment_address: \"\",\n    country: \"\",\n    street_address: \"\",\n    zip: \"\"\n  });\n\n  const handleFormatCountries = countries => {\n    const keys = Object.keys(countries);\n    return keys.map(k => {\n      return {\n        label: countries[k],\n        value: k\n      };\n    });\n  };\n\n  React.useEffect(() => {\n    axios.get(\"http://127.0.0.1:8000/products/country_list/\").then(res => setCountries(handleFormatCountries(res.data)));\n  }, []);\n\n  const handleSubmit = async event => {\n    event.preventDefault();\n    const {\n      error,\n      paymentMethod\n    } = await stripe.createPaymentMethod({\n      type: \"card\",\n      card: elements.getElement(CardElement)\n    });\n\n    if (!error) {\n      const user_id = user.id;\n\n      try {\n        const config = {\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `JWT ${localStorage.getItem(\"access\")}`,\n            Accept: \"application/json\"\n          }\n        };\n        const {\n          data\n        } = await axios.post(`http://127.0.0.1:8000/products/checkout/`, {\n          payment_method_id: paymentMethod.id,\n          user_id,\n          zip: address_data.zip,\n          street_address: address_data.street_address,\n          apartement_address: address_data.apartment_address,\n          country: address_data.country\n        }, config);\n        console.log(data);\n        success();\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  };\n\n  const handleChange = e => {\n    setData({ ...address_data,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const handleSelectChange = (e, {\n    name,\n    value\n  }) => {\n    setData({ ...address_data,\n      [name]: e.label\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-50 m-5\",\n    children: [/*#__PURE__*/_jsxDEV(Form, {\n      children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n        children: \"You need to add addresses before you can complete your purchase\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n        controlId: \"formBasicEmail\",\n        children: /*#__PURE__*/_jsxDEV(Form.Control, {\n          type: \"text\",\n          placeholder: \"Street address\",\n          name: \"street_address\",\n          value: address_data.street_address,\n          onChange: e => handleChange(e)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n        controlId: \"formBasicEmail\",\n        children: /*#__PURE__*/_jsxDEV(Form.Control, {\n          type: \"text\",\n          placeholder: \"Apartment address\",\n          name: \"apartment_address\",\n          value: address_data.apartment_address,\n          onChange: e => handleChange(e)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n        controlId: \"formBasicEmail\",\n        children: /*#__PURE__*/_jsxDEV(Select, {\n          options: countries,\n          placeholder: \"Country\",\n          name: \"country\",\n          label: address_data.country,\n          onChange: handleSelectChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n        controlId: \"formBasicEmail\",\n        children: /*#__PURE__*/_jsxDEV(Form.Control, {\n          type: \"text\",\n          placeholder: \"Postal code\",\n          name: \"zip\",\n          value: address_data.zip,\n          onChange: e => handleChange(e)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"mt-3 mr-5\",\n      onSubmit: handleSubmit,\n      style: {\n        width: \"100%\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"mb-3\",\n        children: \"Would you complete your purchase ?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CardElement, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        className: \"mt-3\",\n        type: \"submit\",\n        disabled: !stripe,\n        style: {\n          width: \"100%\"\n        },\n        children: \"Pay\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n};\n\n_s(CheckoutForm, \"gWTS3LX+K/uajuIlKWWksjMppMs=\", false, function () {\n  return [useStripe, useElements];\n});\n\n_c = CheckoutForm;\n\nconst mapSTP = state => ({\n  user: state.account.user,\n  cart: state.product.cart\n});\n\nexport default connect(mapSTP)(CheckoutForm);\n\nvar _c;\n\n$RefreshReg$(_c, \"CheckoutForm\");","map":{"version":3,"sources":["C:/Users/dardo/Desktop/e-commerce/frontend/src/components/Products/checkoutForm.js"],"names":["React","CardElement","useStripe","useElements","Button","Form","axios","connect","Select","CheckoutForm","success","user","stripe","elements","countries","setCountries","useState","address_data","setData","apartment_address","country","street_address","zip","handleFormatCountries","keys","Object","map","k","label","value","useEffect","get","then","res","data","handleSubmit","event","preventDefault","error","paymentMethod","createPaymentMethod","type","card","getElement","user_id","id","config","headers","Authorization","localStorage","getItem","Accept","post","payment_method_id","apartement_address","console","log","handleChange","e","target","name","handleSelectChange","width","mapSTP","state","account","cart","product"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\r\nimport { Button, Form } from \"react-bootstrap\";\r\nimport axios from \"axios\";\r\nimport { connect } from \"react-redux\";\r\nimport Select from \"react-select\";\r\n\r\nconst CheckoutForm = ({ success, user }) => {\r\n  const stripe = useStripe();\r\n  const elements = useElements();\r\n  const [countries, setCountries] = React.useState([]);\r\n  const [address_data, setData] = React.useState({\r\n    apartment_address: \"\",\r\n    country: \"\",\r\n    street_address: \"\",\r\n    zip: \"\",\r\n  });\r\n\r\n  const handleFormatCountries = (countries) => {\r\n    const keys = Object.keys(countries);\r\n    return keys.map((k) => {\r\n      return {\r\n        label: countries[k],\r\n        value: k,\r\n      };\r\n    });\r\n  };\r\n  React.useEffect(() => {\r\n    axios\r\n      .get(\"http://127.0.0.1:8000/products/country_list/\")\r\n      .then((res) => setCountries(handleFormatCountries(res.data)));\r\n  }, []);\r\n\r\n  const handleSubmit = async (event) => {\r\n    event.preventDefault();\r\n\r\n    const { error, paymentMethod } = await stripe.createPaymentMethod({\r\n      type: \"card\",\r\n      card: elements.getElement(CardElement),\r\n    });\r\n\r\n    if (!error) {\r\n      const user_id = user.id;\r\n      try {\r\n        const config = {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `JWT ${localStorage.getItem(\"access\")}`,\r\n            Accept: \"application/json\",\r\n          },\r\n        };\r\n        const { data } = await axios.post(\r\n          `http://127.0.0.1:8000/products/checkout/`,\r\n          { payment_method_id: paymentMethod.id, user_id, zip : address_data.zip,street_address : address_data.street_address,apartement_address:address_data.apartment_address,country:address_data.country },\r\n          config\r\n        );\r\n        console.log(data);\r\n        success();\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    setData({ ...address_data, [e.target.name]: e.target.value });\r\n  };\r\n  const handleSelectChange = (e, { name, value }) => {\r\n    setData({ ...address_data, [name]: e.label });\r\n  };\r\n\r\n  return (\r\n    <div className=\"w-50 m-5\">\r\n      <Form>\r\n        <h6>You need to add addresses before you can complete your purchase</h6>\r\n        <Form.Group controlId=\"formBasicEmail\">\r\n          <Form.Control\r\n            type=\"text\"\r\n            placeholder=\"Street address\"\r\n            name=\"street_address\"\r\n            value={address_data.street_address}\r\n            onChange={(e) => handleChange(e)}\r\n          />\r\n        </Form.Group>\r\n        <Form.Group controlId=\"formBasicEmail\">\r\n          <Form.Control\r\n            type=\"text\"\r\n            placeholder=\"Apartment address\"\r\n            name=\"apartment_address\"\r\n            value={address_data.apartment_address}\r\n            onChange={(e) => handleChange(e)}\r\n          />\r\n        </Form.Group>\r\n        <Form.Group controlId=\"formBasicEmail\">\r\n          <Select\r\n            options={countries}\r\n            placeholder=\"Country\"\r\n            name=\"country\"\r\n            label={address_data.country}\r\n            onChange={handleSelectChange}\r\n          />\r\n        </Form.Group>\r\n        <Form.Group controlId=\"formBasicEmail\">\r\n          <Form.Control\r\n            type=\"text\"\r\n            placeholder=\"Postal code\"\r\n            name=\"zip\"\r\n            value={address_data.zip}\r\n            onChange={(e) => handleChange(e)}\r\n          />\r\n        </Form.Group>\r\n        \r\n      </Form>\r\n      <form\r\n        className=\"mt-3 mr-5\"\r\n        onSubmit={handleSubmit}\r\n        style={{ width: \"100%\" }}\r\n      >\r\n        <h4 className=\"mb-3\">Would you complete your purchase ?</h4>\r\n        <CardElement />\r\n        <Button\r\n          className=\"mt-3\"\r\n          type=\"submit\"\r\n          disabled={!stripe}\r\n          style={{ width: \"100%\" }}\r\n        >\r\n          Pay\r\n        </Button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\nconst mapSTP = (state) => ({\r\n  user: state.account.user,\r\n  cart: state.product.cart,\r\n});\r\nexport default connect(mapSTP)(CheckoutForm);\r\n"]},"metadata":{},"sourceType":"module"}