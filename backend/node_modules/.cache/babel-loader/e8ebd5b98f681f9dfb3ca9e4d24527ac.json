{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/dardo/Desktop/e-commerce/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/dardo/Desktop/e-commerce/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from\"axios\";import{SIGNUP_SUCCESS,ACTIVATION_SUCCESS,ACTIVATION_FAIL,RESET_PASSWORD_SUCCESS,RESET_PASSWORD_CONFIRM_SUCCESS,RESET_PASSWORD_CONFIRM_FAIL,LOGOUT,LOGIN_SUCCESS,USER_LOADED_SUCCESS,USER_LOADED_FAIL,AUTHENTICATED_SUCCESS,AUTHENTICATED_FAIL,DELETE_USER_SUCCESS}from\"../constants\";import{returnErrors}from\"./errors\";// CHECK AUTHENTICATION\nexport var checkAuthenticated=function checkAuthenticated(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(typeof window==\"undefined\"){dispatch({type:AUTHENTICATED_FAIL});}if(!localStorage.getItem(\"access\")){_context.next=16;break;}config={headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\"}};body=JSON.stringify({token:localStorage.getItem(\"access\")});_context.prev=4;_context.next=7;return axios.post(\"http://127.0.0.1:8000/auth/jwt/verify/\",body,config);case 7:res=_context.sent;if(res.data.code!==\"token_not_valid\"){dispatch({type:AUTHENTICATED_SUCCESS});}else{dispatch({type:AUTHENTICATED_FAIL});}_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](4);dispatch({type:AUTHENTICATED_FAIL});case 14:_context.next=17;break;case 16:dispatch({type:AUTHENTICATED_FAIL});case 17:case\"end\":return _context.stop();}}},_callee,null,[[4,11]]);}));return function(_x){return _ref.apply(this,arguments);};}();};// REGISTER A NEW USER\nexport var sign_up=function sign_up(_ref2){var name=_ref2.name,email=_ref2.email,password=_ref2.password,re_password=_ref2.re_password;return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};body=JSON.stringify({name:name,email:email,password:password,re_password:re_password});_context2.prev=2;_context2.next=5;return axios.post(\"http://127.0.0.1:8000/auth/users/\",body,config);case 5:res=_context2.sent;dispatch({type:SIGNUP_SUCCESS,payload:res.data});_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](2);dispatch(returnErrors({msg:_context2.t0.response.data,status:_context2.t0.response.status,id:\"SIGNUP_FAIL\"}));case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[2,9]]);}));return function(_x2){return _ref3.apply(this,arguments);};}();};// VERIFY WITH AN EMAIL SENT TO USER'S EMAIL\nexport var verify=function verify(uid,token){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};body=JSON.stringify({uid:uid,token:token});_context3.prev=2;_context3.next=5;return axios.post(\"http://127.0.0.1:8000/auth/users/activation/\",body,config);case 5:res=_context3.sent;dispatch({type:ACTIVATION_SUCCESS,payload:res.data});_context3.next=12;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](2);dispatch({type:ACTIVATION_FAIL});case 12:case\"end\":return _context3.stop();}}},_callee3,null,[[2,9]]);}));return function(_x3){return _ref4.apply(this,arguments);};}();};// LOGIN A USER\nexport var login=function login(email,password){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};body=JSON.stringify({email:email,password:password});_context4.prev=2;_context4.next=5;return axios.post(\"http://127.0.0.1:8000/auth/jwt/create/\",body,config);case 5:res=_context4.sent;dispatch({type:LOGIN_SUCCESS,payload:res.data});dispatch(load_user());_context4.next=13;break;case 10:_context4.prev=10;_context4.t0=_context4[\"catch\"](2);dispatch(returnErrors({msg:_context4.t0.response.data,status:_context4.t0.response.status,id:\"LOGIN_FAIL\"}));case 13:case\"end\":return _context4.stop();}}},_callee4,null,[[2,10]]);}));return function(_x4){return _ref5.apply(this,arguments);};}();};// LOAD A USER\nexport var load_user=function load_user(){return/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){var config,res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(!localStorage.getItem(\"access\")){_context5.next=14;break;}config={headers:{\"Content-Type\":\"application/json\",Authorization:\"JWT \".concat(localStorage.getItem(\"access\")),Accept:\"application/json\"}};_context5.prev=2;_context5.next=5;return axios.get(\"http://127.0.0.1:8000/auth/users/me/\",config);case 5:res=_context5.sent;dispatch({type:USER_LOADED_SUCCESS,payload:res.data});_context5.next=12;break;case 9:_context5.prev=9;_context5.t0=_context5[\"catch\"](2);dispatch({type:USER_LOADED_FAIL});case 12:_context5.next=15;break;case 14:dispatch({type:USER_LOADED_FAIL});case 15:case\"end\":return _context5.stop();}}},_callee5,null,[[2,9]]);}));return function(_x5){return _ref6.apply(this,arguments);};}();};// FORGET PASSWORD ----> SENT AN EMAIL TO CONFIRM\nexport var reset_password=function reset_password(email){return/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};body=JSON.stringify({email:email});_context6.prev=2;_context6.next=5;return axios.post(\"http://127.0.0.1:8000/auth/users/reset_password/\",body,config);case 5:res=_context6.sent;dispatch({type:RESET_PASSWORD_SUCCESS,payload:res.data});_context6.next=12;break;case 9:_context6.prev=9;_context6.t0=_context6[\"catch\"](2);dispatch(returnErrors({msg:_context6.t0.response.data,status:_context6.t0.response.status,id:\"RESET_PASSWORD_FAIL\"}));case 12:case\"end\":return _context6.stop();}}},_callee6,null,[[2,9]]);}));return function(_x6){return _ref7.apply(this,arguments);};}();};// RESET A NEW PASSWORD WITH LIEN SENT IN EMAIL\nexport var reset_password_confirm=function reset_password_confirm(uid,token,new_password,re_new_password){return/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};body=JSON.stringify({uid:uid,token:token,new_password:new_password,re_new_password:re_new_password});_context7.prev=2;_context7.next=5;return axios.post(\"http://127.0.0.1:8000/auth/users/reset_password_confirm/\",body,config);case 5:res=_context7.sent;dispatch({type:RESET_PASSWORD_CONFIRM_SUCCESS,payload:res.data});_context7.next=12;break;case 9:_context7.prev=9;_context7.t0=_context7[\"catch\"](2);dispatch({type:RESET_PASSWORD_CONFIRM_FAIL});case 12:case\"end\":return _context7.stop();}}},_callee7,null,[[2,9]]);}));return function(_x7){return _ref8.apply(this,arguments);};}();};// Delete User\nexport var deleteUser=function deleteUser(current_password){return/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(dispatch){var config,body,set;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:config={headers:{\"Content-Type\":\"application/json\",Authorization:\"JWT \".concat(localStorage.getItem(\"access\")),Accept:\"application/json\"}};body=JSON.stringify({current_password:current_password});_context8.prev=2;_context8.next=5;return axios.delete(\"http://127.0.0.1:8000/auth/users/me/\",current_password,config);case 5:set=_context8.sent;dispatch({type:DELETE_USER_SUCCESS});_context8.next=12;break;case 9:_context8.prev=9;_context8.t0=_context8[\"catch\"](2);console.log(current_password);case 12:case\"end\":return _context8.stop();}}},_callee8,null,[[2,9]]);}));return function(_x8){return _ref9.apply(this,arguments);};}();};// LOGOUT\nexport var logout=function logout(){return/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(dispatch){return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:dispatch({type:LOGOUT});case 1:case\"end\":return _context9.stop();}}},_callee9);}));return function(_x9){return _ref10.apply(this,arguments);};}();};","map":{"version":3,"sources":["C:/Users/dardo/Desktop/e-commerce/frontend/src/JS/actions/account.js"],"names":["axios","SIGNUP_SUCCESS","ACTIVATION_SUCCESS","ACTIVATION_FAIL","RESET_PASSWORD_SUCCESS","RESET_PASSWORD_CONFIRM_SUCCESS","RESET_PASSWORD_CONFIRM_FAIL","LOGOUT","LOGIN_SUCCESS","USER_LOADED_SUCCESS","USER_LOADED_FAIL","AUTHENTICATED_SUCCESS","AUTHENTICATED_FAIL","DELETE_USER_SUCCESS","returnErrors","checkAuthenticated","dispatch","window","type","localStorage","getItem","config","headers","Accept","body","JSON","stringify","token","post","res","data","code","sign_up","name","email","password","re_password","payload","msg","response","status","id","verify","uid","login","load_user","Authorization","get","reset_password","reset_password_confirm","new_password","re_new_password","deleteUser","current_password","delete","set","console","log","logout"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\n\r\nimport {\r\n  SIGNUP_SUCCESS,\r\n  ACTIVATION_SUCCESS,\r\n  ACTIVATION_FAIL,\r\n  RESET_PASSWORD_SUCCESS,\r\n  RESET_PASSWORD_CONFIRM_SUCCESS,\r\n  RESET_PASSWORD_CONFIRM_FAIL,\r\n  LOGOUT,\r\n  LOGIN_SUCCESS,\r\n  USER_LOADED_SUCCESS,\r\n  USER_LOADED_FAIL,\r\n  AUTHENTICATED_SUCCESS,\r\n  AUTHENTICATED_FAIL,\r\n  DELETE_USER_SUCCESS,\r\n} from \"../constants\";\r\n\r\nimport { returnErrors } from \"./errors\";\r\n\r\n// CHECK AUTHENTICATION\r\nexport const checkAuthenticated = () => async (dispatch) => {\r\n  if (typeof window == \"undefined\") {\r\n    dispatch({\r\n      type: AUTHENTICATED_FAIL,\r\n    });\r\n  }\r\n  if (localStorage.getItem(\"access\")) {\r\n    const config = {\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    };\r\n\r\n    const body = JSON.stringify({ token: localStorage.getItem(\"access\") });\r\n\r\n    try {\r\n      const res = await axios.post(\r\n        `http://127.0.0.1:8000/auth/jwt/verify/`,\r\n        body,\r\n        config\r\n      );\r\n\r\n      if (res.data.code !== \"token_not_valid\") {\r\n        dispatch({\r\n          type: AUTHENTICATED_SUCCESS,\r\n        });\r\n      } else {\r\n        dispatch({\r\n          type: AUTHENTICATED_FAIL,\r\n        });\r\n      }\r\n    } catch (err) {\r\n      dispatch({\r\n        type: AUTHENTICATED_FAIL,\r\n      });\r\n    }\r\n  } else {\r\n    dispatch({\r\n      type: AUTHENTICATED_FAIL,\r\n    });\r\n  }\r\n};\r\n\r\n// REGISTER A NEW USER\r\nexport const sign_up = ({ name, email, password, re_password }) => async (\r\n  dispatch\r\n) => {\r\n  const config = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n  };\r\n  const body = JSON.stringify({ name, email, password, re_password });\r\n  try {\r\n    const res = await axios.post(\r\n      `http://127.0.0.1:8000/auth/users/`,\r\n      body,\r\n      config\r\n    );\r\n\r\n    dispatch({\r\n      type: SIGNUP_SUCCESS,\r\n      payload: res.data,\r\n    });\r\n  } catch (error) {\r\n    dispatch(\r\n      returnErrors({\r\n        msg: error.response.data,\r\n        status: error.response.status,\r\n        id: \"SIGNUP_FAIL\",\r\n      })\r\n    );\r\n  }\r\n};\r\n\r\n// VERIFY WITH AN EMAIL SENT TO USER'S EMAIL\r\nexport const verify = (uid, token) => async (dispatch) => {\r\n  const config = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n  };\r\n\r\n  const body = JSON.stringify({ uid, token });\r\n\r\n  try {\r\n    const res = await axios.post(\r\n      `http://127.0.0.1:8000/auth/users/activation/`,\r\n      body,\r\n      config\r\n    );\r\n\r\n    dispatch({\r\n      type: ACTIVATION_SUCCESS,\r\n      payload: res.data,\r\n    });\r\n  } catch (err) {\r\n    dispatch({\r\n      type: ACTIVATION_FAIL,\r\n    });\r\n  }\r\n};\r\n\r\n// LOGIN A USER\r\nexport const login = (email, password) => async (dispatch) => {\r\n  const config = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n  };\r\n\r\n  const body = JSON.stringify({ email, password });\r\n\r\n  try {\r\n    const res = await axios.post(\r\n      `http://127.0.0.1:8000/auth/jwt/create/`,\r\n      body,\r\n      config\r\n    );\r\n\r\n    dispatch({\r\n      type: LOGIN_SUCCESS,\r\n      payload: res.data,\r\n    });\r\n\r\n    dispatch(load_user());\r\n  } catch (error) {\r\n    dispatch(\r\n      returnErrors({\r\n        msg: error.response.data,\r\n        status: error.response.status,\r\n        id: \"LOGIN_FAIL\",\r\n      })\r\n    );\r\n  }\r\n};\r\n\r\n// LOAD A USER\r\nexport const load_user = () => async (dispatch) => {\r\n  if (localStorage.getItem(\"access\")) {\r\n    const config = {\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `JWT ${localStorage.getItem(\"access\")}`,\r\n        Accept: \"application/json\",\r\n      },\r\n    };\r\n\r\n    try {\r\n      const res = await axios.get(\r\n        `http://127.0.0.1:8000/auth/users/me/`,\r\n        config\r\n      );\r\n\r\n      dispatch({\r\n        type: USER_LOADED_SUCCESS,\r\n        payload: res.data,\r\n      });\r\n    } catch (err) {\r\n      dispatch({\r\n        type: USER_LOADED_FAIL,\r\n      });\r\n    }\r\n  } else {\r\n    dispatch({\r\n      type: USER_LOADED_FAIL,\r\n    });\r\n  }\r\n};\r\n\r\n// FORGET PASSWORD ----> SENT AN EMAIL TO CONFIRM\r\nexport const reset_password = (email) => async (dispatch) => {\r\n  const config = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n  };\r\n\r\n  const body = JSON.stringify({ email });\r\n\r\n  try {\r\n    const res = await axios.post(\r\n      `http://127.0.0.1:8000/auth/users/reset_password/`,\r\n      body,\r\n      config\r\n    );\r\n\r\n    dispatch({\r\n      type: RESET_PASSWORD_SUCCESS,\r\n      payload: res.data,\r\n    });\r\n  } catch (error) {\r\n    dispatch(\r\n      returnErrors({\r\n        msg: error.response.data,\r\n        status: error.response.status,\r\n        id: \"RESET_PASSWORD_FAIL\",\r\n      })\r\n    );\r\n  }\r\n};\r\n\r\n// RESET A NEW PASSWORD WITH LIEN SENT IN EMAIL\r\nexport const reset_password_confirm = (\r\n  uid,\r\n  token,\r\n  new_password,\r\n  re_new_password\r\n) => async (dispatch) => {\r\n  const config = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n  };\r\n\r\n  const body = JSON.stringify({ uid, token, new_password, re_new_password });\r\n\r\n  try {\r\n    const res = await axios.post(\r\n      `http://127.0.0.1:8000/auth/users/reset_password_confirm/`,\r\n      body,\r\n      config\r\n    );\r\n\r\n    dispatch({\r\n      type: RESET_PASSWORD_CONFIRM_SUCCESS,\r\n      payload: res.data,\r\n    });\r\n  } catch (err) {\r\n    dispatch({\r\n      type: RESET_PASSWORD_CONFIRM_FAIL,\r\n    });\r\n  }\r\n};\r\n\r\n// Delete User\r\nexport const deleteUser = (current_password) => async (dispatch) => {\r\n  const config = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `JWT ${localStorage.getItem(\"access\")}`,\r\n      Accept: \"application/json\",\r\n    },\r\n  };\r\n\r\n  const body = JSON.stringify({current_password});\r\n\r\n  try {\r\n    const set = await axios.delete(\r\n      `http://127.0.0.1:8000/auth/users/me/`,\r\n      current_password,\r\n      config\r\n    );\r\n    dispatch({\r\n      type: DELETE_USER_SUCCESS,\r\n    });\r\n  } catch (error) {\r\n    console.log(current_password)\r\n  }\r\n};\r\n\r\n// LOGOUT\r\nexport const logout = () => async (dispatch) => {\r\n  dispatch({ type: LOGOUT });\r\n};\r\n"]},"metadata":{},"sourceType":"module"}